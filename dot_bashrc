#!/usr/bin/env bash
# ~/.bashrc - Bash configuration

# -----------------------------
# Load unified shell modules
# -----------------------------
[ -f ~/.shell/exports.sh ] && source ~/.shell/exports.sh
[ -f ~/.shell/aliases.sh ] && source ~/.shell/aliases.sh
[ -f ~/.shell/functions.sh ] && source ~/.shell/functions.sh
[ -f ~/.shell/local.sh ] && source ~/.shell/local.sh

# -----------------------------
# Bash-specific settings
# -----------------------------

# History settings (bash-specific behavior)
shopt -s histappend         # Append to history instead of overwriting
shopt -s cmdhist            # Save multi-line commands as a single entry

# Share history across terminals
export PROMPT_COMMAND="history -a; history -c; history -r; $PROMPT_COMMAND"

# -----------------------------
# Key Bindings (History Search)
# -----------------------------

# Enable arrow key history search
bind '"\e[A": history-search-backward'
bind '"\e[B": history-search-forward'

# -----------------------------
# Completion System
# -----------------------------

# Enable programmable completion
if [ -f /etc/bash_completion ]; then
    source /etc/bash_completion
fi

if [ -f /usr/share/bash-completion/bash_completion ]; then
    source /usr/share/bash-completion/bash_completion
fi

# -----------------------------
# Tool Initializations
# -----------------------------

# Starship prompt
if command -v starship &>/dev/null; then
    eval "$(starship init bash)"
fi

# FZF integration
if command -v fzf &>/dev/null; then
    eval "$(fzf --bash)"
fi

# Zoxide integration
if command -v zoxide &>/dev/null; then
    eval "$(zoxide init bash --cmd cd)"
fi

# -----------------------------
# Welcome message
# -----------------------------
if command -v fastfetch &>/dev/null; then
    fastfetch
fi